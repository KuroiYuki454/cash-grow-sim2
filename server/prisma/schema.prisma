// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "./generated/prisma"
}

datasource db {
  provider = "mysql"
}

model PlayerAccount {
  id               String   @id @default(cuid())
  email            String   @unique
  password_hash    String
  balance          Float    @default(0.00)
  income_per_second Float    @default(0.00)
  last_updated_at  DateTime @default(now())
  created_at       DateTime @default(now())
  
  purchased_upgrades PurchasedUpgrade[]
  random_event_state RandomEventState?
  
  @@map("player_accounts")
}

model Upgrade {
  id               String  @id
  name             String
  description      String
  cost             Float
  income_boost     Float
  icon             String
  sort_order       Int
  cost_multiplier  Float
  income_multiplier Float
  
  purchased_upgrades PurchasedUpgrade[]
  
  @@map("upgrades")
}

model PurchasedUpgrade {
  id         String @id @default(cuid())
  account_id String
  upgrade_id String
  level      Int    @default(1)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  
  account PlayerAccount @relation(fields: [account_id], references: [id], onDelete: Cascade)
  upgrade  Upgrade       @relation(fields: [upgrade_id], references: [id], onDelete: Cascade)
  
  @@unique([account_id, upgrade_id])
  @@map("purchased_upgrades")
}

model RandomEventState {
  id             String   @id @default(cuid())
  account_id     String   @unique
  active_event_id String?
  multiplier     Float    @default(1.0)
  started_at     DateTime?
  ends_at        DateTime?
  next_event_at  DateTime?
  updated_at     DateTime @updatedAt

  account PlayerAccount @relation(fields: [account_id], references: [id], onDelete: Cascade)

  @@map("random_event_states")
}
